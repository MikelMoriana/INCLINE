---
title: "INCLINE Readme"
# author: "Joseph Gaudard"
# date: "1/14/2022"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("data_doc/INCLINE_data-dictionnary.R")

cflux <- read_csv("data_cleaned/INCLINE_c-flux_2020.csv", col_types = "cddddddfffcTfd")
ndvi <- read_csv("data_cleaned/INCLINE_NDVI_2019_2020_2021.csv", col_types = "fdDffffcc")
biomass_removal <- read_csv("data_cleaned/INCLINE_biomass_removal.csv", col_types = "dDfDfDfffcffd")
demography_Sib_pro <- read_csv("data_cleaned/INCLINE_demography_Sib_pro.csv", col_types = "fffdDfffcffddfffd")
demography_Ver_alp <- read_csv("data_cleaned/INCLINE_demography_Ver_alp.csv", col_types = "fffdDfffcffddfffd")
seedling_traits_alpine <- read_csv("data_cleaned/INCLINE_seedling_traits_alpine.csv", col_types = "ffffffcfDDcfffcfd")
seedling_data_alpine <- read_csv("data_cleaned/INCLINE_seedling_data_alpine.csv", col_types = "cffffffffDfddfdddddc")
seedling_data_subalpine <- read_csv("data_cleaned/INCLINE_seedling_data_subalpine.csv", col_types = "ffffffcfdddfddDf")
seedbank_survival <- read_csv("data_cleaned/INCLINE_seedbank_survival.csv", col_types = "fffffcDDfcc")
seeds_per_capsule <- read_csv("data_cleaned/INCLINE_seeds_per_capsule.csv", col_types = "ffDccfdcd")
species_level_biomass_allocation <- read_csv("data_cleaned/INCLINE_species_level_biomass_allocation.csv", col_types = "fffDcfffffcccfd")
flowering <- read_csv("data_cleaned/INCLINE_flowering.csv", col_types = "fffffffDDDffcffd")

```

# Introduction

# Method

## Sites

## Design

## Treatments

# Data management

## Location

## Naming convention

## Data collection

**Ecosystem fluxes** Net ecosystem exchange (NEE) and ecosystem respiration (ER) were measured on the field while gross ecosystem production (GEP) is calculated as GEP = NEE - ER.
Carbon fluxes are measured with a closed loop chamber system connected to an infrared gaz analyser (INGRA; Li-840A, Li-cor).
The plexiglas chamber (25x35x40 cm) is connected to the INGRA with plastic tubes (inlet and outlet, 3m long and 4mm diameter each).
A filter prevents water droplets and small particules from entering the INGRA and an air pump ensures a constant flow of 1L/mn.
The chamber is equiped with a fan to mix the air, a thermocouple (Pt1000, Delta-T) to measure air temperature and a PAR sensor.
In 2020 the air temperature was measured with an iButton.
Airtightness is ensured by laying a heavy chain on the "skirt" of the chamber (a piece of tarp taped to the lower part of the chamber).
NEE is measured with a transparent chamber.
ER is measured with a dark chamber, in our case the transparent chamber was covered with a thick dark tarp.
The CO~2~ concentration was measured every seconds and logged in a datalogger (Squirrel 2010).
The chamber was put on the plot during three (two in 2020) minutes for each measurements and then aired during one minute.
Since the logger was logging continuesly, the start and end time of each measurement was noted (it is necessary to precisely synchronise the logger clock with the watch used on the field and to regularly check it).
The function `match.flux()` is matching the time in the logger file with the plot being measured at that time (using the time recorded on the field).
It attributes the concentration of CO~2~ measured every seconds to the correct measurement.
A linear regression is fitted to every measurements and the slope is used to calculated the flux.
<!-- This is the code to keep in case we want to extract a pdf -->
<!-- $$ -->
<!--  \text{flux}=\text{slope}\times \frac{P\times V}{R\times T\times A} -->
<!-- $$ -->
<!-- - flux: the flux of CO~2~ at the surface of the plot ($mmol/m^2/h$) -->
<!-- - slope: slope of linear regression fitting the CO~2~ concentration versus time ($ppm^{-1}$) -->
<!-- - $P$: pressure, assumed 1 atm -->
<!-- - $V$: volume of the chamber and tubing ($L$) -->
<!-- - $R$: gas constant ($0.082057\ L*atm*K^{-1}*mol^{-1}$) -->
<!-- - $T$: chamber air temperature ($K$) -->
<!-- - $A$: area of chamber frame base ($m^2$) -->

<img src="https://render.githubusercontent.com/render/math?math=flux=slope\times \frac{P\times V}{R\times T\times A}">

Where:

- flux: the flux of CO~2~ at the surface of the plot (mmol/m^2^/h)
- slope: slope of linear regression fitting the CO~2~ concentration versus time (ppm^-1^)
- P: pressure, assumed 1 atm
- V: volume of the chamber and tubing (L)
- R: gas constant (0.082057 L\*atm\*K^-1^\*mol^-1^)
- T: chamber air temperature (K)
- A: area of chamber frame base (m^2^)

## Data dictionnaries

### Biomass removal (dataset i)

This dataset contains the biomass removed per experimental plot and functional group per year (the cleaned dataset can be accessed from here: link). From  40 experimental plots across four sites we removed a total of `r sum(biomass_removal$value, na.rm = TRUE)` g biomass over the project period; `r sum((biomass_removal %>% filter(functional_group == "Graminoid") %>% select(value)), na.rm = TRUE)` g graminoids, `r sum((biomass_removal %>% filter(functional_group == "Bryophyte") %>% select(value)), na.rm = TRUE)` g bryophytes, `r sum((biomass_removal %>% filter(functional_group == "Forb") %>% select(value)), na.rm = TRUE)` g forbs, but the most biomass came from litter with as much as `r sum((biomass_removal %>% filter(functional_group == "Litter") %>% select(value)), na.rm = TRUE)` g. Biomass removed decreased over time, `r sum((biomass_removal %>% filter(year == 2019) %>% select(value)), na.rm = TRUE)` g in 2019, `r sum((biomass_removal %>% filter(year == 2020) %>% select(value)), na.rm = TRUE)` g in 2020, and `r sum((biomass_removal %>% filter(year == 2021) %>% select(value)), na.rm = TRUE)` g in 2021, suggesting that the removal treatment did cause a decline in returning biomass every year.


```{r, echo=FALSE}
knitr::kable(biomass_removal_dic)
```

### Plant community composition (dataset ii)

These data will be finished over the summer of 2022, and will be added to this data descriptor once the dataset is complete.

### Population dynamics of alpine focal species (dataset iii)

These datasets contains demographic data on two species. Over the period from 2018-2021 we followed `r length(unique(demography_Sib_pro$uniqueID))` individuals of Sibbaldia procumbens, and `r length(unique(demography_Ver_alp$uniqueID))` individuals of Veronica alpina. The cleaned data can be accessed ... To build population models this dataset needs to be combined with dataset iv) species-level biomass allocation to calculate an estimate of the link between the size traits measured non distructively in the field in this dataset (iii) with the actual biomass (dataset iv). 

```{r, echo=FALSE}
knitr::kable(demography_Sib_pro_dic)
knitr::kable(demography_Ver_alp_dic)
```


### Carbon fluxes
```{r cfluxdic, echo=FALSE}
knitr::kable(cflux_dic)
```

### Climate
```{r, echo=FALSE}
knitr::kable(microclimate_dic)
```

### Flowering
```{r, echo=FALSE}
knitr::kable(flowering_dic)
```

### Germination
```{r, echo=FALSE}
knitr::kable(seedling_traits_alpine_dic)
knitr::kable(seedling_data_alpine_dic)
knitr::kable(seedling_data_subalpine_dic)
```

### NDVI
```{r, echo=FALSE}
knitr::kable(ndvi_dic)
```

### Seedbank
```{r, echo=FALSE}
knitr::kable(seedbank_survival_dic)
```



### Seeds per capsule
```{r, echo=FALSE}
knitr::kable(seeds_per_capsule_dic)
```

### Species level biomass allocation
```{r, echo=FALSE}
knitr::kable(species_level_biomass_allocation_dic)
```


<!-- ### -->
<!-- ```{r, echo=FALSE} -->
<!-- knitr::kable() -->
<!-- ``` -->

<!-- ### -->
<!-- ```{r, echo=FALSE} -->
<!-- knitr::kable() -->
<!-- ``` -->

<!-- ### -->
<!-- ```{r, echo=FALSE} -->
<!-- knitr::kable() -->
<!-- ``` -->

<!-- ### -->
<!-- ```{r, echo=FALSE} -->
<!-- knitr::kable() -->
<!-- ``` -->

<!-- ### -->
<!-- ```{r, echo=FALSE} -->
<!-- knitr::kable() -->
<!-- ``` -->